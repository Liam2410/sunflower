<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Boostrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Load an icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <script src="/App/View/Source/Javascript/DisplayCommentDate.js"></script>

    <title>Đánh giá giáo viên</title>

    <style>

        .divider{
            padding: 0 3px 0 3px;
        }

        .header-top a{
            color: #5cb85c;
        }

        .highlight-name{
            color: #5cb85c;
        }

        .bg{
            background-image: linear-gradient(rgba(0, 0, 0, 0.327),rgba(0, 0, 0, 0.3)), url('/App/View/Source/Image/english-class-background.png');
            height: 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }

        .star{
            display: none;
        }

        .detail-section-background{
            background-color: #eef3a3;
            background-image: linear-gradient(160deg, #eef0e8 0%, #eef5b5 100%);
            border-top-left-radius: 8px; border-bottom-left-radius: 8px;
        }

        #account_detail_form{
            border-radius: 8px;
            background-color: white;
        }

        #account_avtar_column{
            background-color: #85FFBD;
            background-image: linear-gradient(45deg, #85FFBD 0%, #FFFB7D 100%);
            border-top-left-radius: 8px; border-bottom-left-radius: 8px;
        }

        footer{
            background-color: #2F2F2F;
            color: white;
        }

        footer .container .active{
            color: white;
        }
        footer .container p{
            color: gray;
        }
        
        footer .container a{
            color: gray;
        }

        footer .container p:hover{
            color: white;
        }
        footer .container a:hover{
            color: white;
        }

        footer .container .copyright p:hover{
            color: gray;
        }

        .breadcrumb{
            background-color: #925F17;
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 1px 5px 0 rgba(0, 0, 0, .12), 0 3px 1px -2px rgba(0, 0, 0, .2);
            width: 100%;
        }

        .breadcrumb li{
            padding: 0px 10px;
            color: white;
        }

        .breadcrumb li a{
            padding: 0px 10px;
            color: white;
            text-decoration: none;
        }

        .breadcrumb .active{
            color: #FBE205;
            font-style: italic;
        }

        .breadcrumb li a:hover{
            text-decoration: underline;
            color: #FBE205;
        }
    </style>
</head>
<body>

    <!--Header khi đã đăng nhập-->
    {% if fullname %}
        <div class="header-top">
            <div class="container">
                <div class="row">
                        <div class="col" style="font-weight: bold;">Hotline: <span class="highlight-name">0379028110</span> <span class="divider">|</span> Email: <span class="highlight-name">sunflower@gmail.com</span></div>
                        <div class="col text-right" style="font-weight: bold;">
                            Xin chào <a href="/account/detail">{{fullname}}</a>
                            <span class="divider">|</span>
                            <a href="/account/logout">Đăng xuất</a>
                            <span class="divider">|</span>
                            <a href="/search/index">Tìm kiếm</a>
                        </div>
                </div>
            </div>
        </div>
    {% endif %}
    <!--Header khi chưa đăng nhập-->
    {% if not fullname %}
        <div class="header-top">
            <div class="container">
                <div class="row">
                        <div class="col" style="font-weight: bold;">Hotline: <span class="highlight-name">0379028110</span> <span class="divider">|</span> Email: <span class="highlight-name">sunflower@gmail.com</span></div>
                        <div class="col text-right" style="font-weight: bold;">
                            <a href="/account/login">Đăng nhập</a>
                            <span class="divider">|</span>
                            <a href="/account/register">Đăng ký</a>
                        </div>
                </div>
            </div>
        </div>
    {% endif %}

    <!--Nav-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-success">
        <a class="navbar-brand" href="#"><img src="/App/View/Source/Image/SunflowerLogo.png" alt="Logo" style="width:200px;height: 75px;"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav ml-auto">
                    <li class="nav-item mr-3">
                        <a class="nav-link" href="/home/index">Trang chủ <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item mr-3">
                        <a class="nav-link" href="/news/getnews">Tin tức</a>
                    </li>
                    <li class="nav-item mr-3">
                        <a class="nav-link" href="/schedule/index">Thời khóa biểu</a>
                    </li>
                    <li class="nav-item mr-3">
                        <a class="nav-link" href="/rating/getteachers">Đánh giá</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Khóa học
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <a class="dropdown-item" href="/course/searchcourse?course-name-input=&course-language=Tiếng Anh">Tiếng Anh</a>
                            <a class="dropdown-item" href="/course/searchcourse?course-name-input=&course-language=Tiếng Trung">Tiếng Trung</a>
                            <a class="dropdown-item" href="/course/searchcourse?course-name-input=&course-language=Tiếng Hàn">Tiếng Hàn</a>
                            <a class="dropdown-item" href="/course/searchcourse?course-name-input=&course-language=Tiếng Nhật">Tiếng Nhật</a>
                        </div>
                    </li>
            </ul>
        </div>
    </nav>

    <ul class="breadcrumb">
        <li><a href="/home/index">Trang chủ</a></li>
        <li><i class="fa fa-chevron-right" aria-hidden="true"></i></li>
        <li><a href="/rating/getTeachers">Danh sách giáo viên</a></li>
        <li><i class="fa fa-chevron-right" aria-hidden="true"></i></li>
        <li class="active">Đánh giá giáo viên {{teacher.Fullname}}</li>                    
    </ul>

    {% if fullname is null %}
        <div class="container">
            <div class="alert alert-warning">
                <h4 class="alert-heading"><i class="fa fa-sign-in" aria-hidden="true"></i> HÃY ĐĂNG NHẬP ĐỂ TIẾP TỤC !</h4>
                <br>
                <p>Để tiếp tục sử dụng tính năng <b>đánh giá</b> này bạn cần phải đăng nhập tài khoản của bạn vào hệ thống.</p>
                <hr>
                <div class="text-right">
                    <a href="/account/login" class="btn btn-warning mr-2">Đăng nhập</a>
                    <a href="/account/register" class="text-warning"><b>hoặc tạo một tài khoản mới</b></a>
                </div>
            </div>
        </div>
    {% endif %}

    {% if fullname is not null %}
        <div class="bg py-2">
            <div class="" style="height: 150px;"></div>
            <div class="container">
                <div class="row">
                    <img class="rounded-circle" src="{{teacherInfor.AvatarURL}}" width="192px" height="192px">
                    <div class="col-md-6">
                        <h1 class="text-light mt-3">{{teacherInfor.Fullname}}</h1>
                        <h3 class="text-light my-4"><i class="fa fa-globe" aria-hidden="true"></i>
                            {{teacherInfor.Language}}</h3>
                        <h5 class="text-light">
                            <span>
                                <i class="fa fa-envelope-o" aria-hidden="true"></i> 
                                {{teacherInfor.Email}}
                            </span>
                            <span class="mx-4">
                                <i class="fa fa-mobile" aria-hidden="true"></i>
                                {{teacherInfor.PhoneNumber}}
                            </span>
                        </h5>
                    </div>

                    <div class="col text-right text-light my-5">
                        <div class="text-center">
                            <h5>Điểm đánh giá</h5>
                            <h1>{{'%.1f'| format(teacher.AvgRating)}} 
                                <span class="text-warning"><i class="fa fa-star" aria-hidden="true"></i></span>
                            </h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-light">
            <div class="container">
                <div class="card-body shadow" style="background-color: white; border-radius: 4px;">
                    <h1 class="text-center">GIỚI THIỆU</h1>
                    <div class="text-center m-auto" style="width: 450px;">
                        <i class="fa fa-quote-left" aria-hidden="true"></i>
                        <span>
                            {{teacherInfor.Degree}}
                        </span>
                        <i class="fa fa-quote-right" aria-hidden="true"></i>
                    </div>
                </div>

                
                <div class="list-group my-3 shadow">
                    <div class="list-group-item bg-success text-white text-center">
                        <h5>Đánh giá của học viên</h5>
                    </div>
                    <div class="list-group-item">
                        <div class="user-comment-section m-auto">
                            <form action="/rating/TeacherRatingPost" method="POST">
                                <input type="hidden" name="id-teacher" value="{{teacherInfor.Id}}">
                                <input id="rating-point" type="hidden" name="rating-point" value="0">
                                <textarea class="form-control" rows="3" placeholder="Bạn nghĩ gì về giáo viên này..." name="comment-content" required></textarea>
                                <div class="text-center m-auto">
                                    <h5 class="mt-2">Điểm đánh giá của bạn</h5>
                                    <h5>
                                        <div id="rating-form">
                                            <input class="star" onclick="displayRatingPointToStar('1')" id="star-1" type="radio" name="rating-point" value="0" required/>
                                            <label class="star-icon fa fa-star-o" for="star-1"></label>
                                            <input class="star" onclick="displayRatingPointToStar('2')" id="star-2" type="radio" name="rating-point" value="0"/>
                                            <label class="star-icon fa fa-star-o" for="star-2"></label>
                                            <input class="star" onclick="displayRatingPointToStar('3')" id="star-3" type="radio" name="rating-point" value="0"/>
                                            <label class="star-icon fa fa-star-o" for="star-3"></label>
                                            <input class="star" onclick="displayRatingPointToStar('4')" id="star-4" type="radio" name="rating-point" value="0"/>
                                            <label class="star-icon fa fa-star-o" for="star-4"></label>
                                            <input class="star" onclick="displayRatingPointToStar('5')" id="star-5" type="radio" name="rating-point" value="0"/>
                                            <label class="star-icon fa fa-star-o" for="star-5"></label>
                                        </div>
                                    </h5>
                                    {% if studentTeacher|length == 0 %}
                                        <button class="btn btn-outline-danger my-2" type="button">
                                            <i class="fa fa-ban" aria-hidden="true"></i> Bạn chưa học giảng viên này
                                        </button>
                                    {% endif %}

                                    {% if studentTeacher|length > 0 %}
                                        <button class="btn btn-outline-success my-2" type="submit">
                                            <i class="fa fa-paper-plane-o" aria-hidden="true"></i> Gửi bình luận và đánh giá
                                        </button>
                                    {% endif %}
                                </div>
                            </form>
                        </div>
                    </div>

                    {% if ratingCount.TotalRating > 0 %}
                        <div class="list-group-item">
                            <div class="row d-flex align-items-center">
                                <div class="col-md-4 text-center">
                                    <h1>{{'%.1f'| format(teacher.AvgRating)}} <i class="fa fa-star text-warning" aria-hidden="true"></i></h1>
                                    <h5>{{ratingCount.TotalRating}} lượt đánh giá</h5>
                                </div>

                                <div class="col-md-6 text-center">
                                    <div class="progress w-80 my-1">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: {{(ratingCount.FivePoint / ratingCount.TotalRating)*100}}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>

                                    <div class="progress w-80 my-2">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: {{(ratingCount.FourPoint / ratingCount.TotalRating)*100}}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>

                                    <div class="progress w-80 my-2">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: {{(ratingCount.ThreePoint / ratingCount.TotalRating)*100}}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>

                                    <div class="progress w-80 my-2">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: {{(ratingCount.TwoPoint / ratingCount.TotalRating)*100}}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>

                                    <div class="progress w-80 my-2">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: {{(ratingCount.OnePoint / ratingCount.TotalRating)*100}}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                
                                <div class="col-md-2">
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span>{{'%.0f'|format((ratingCount.FivePoint / ratingCount.TotalRating)*100)}}%</span>   
                                    <br>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span> 
                                    <span>{{'%.0f'|format((ratingCount.FourPoint / ratingCount.TotalRating)*100)}}%</span>
                                    <br>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star" aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span>{{'%.0f'|format((ratingCount.ThreePoint / ratingCount.TotalRating)*100)}}%</span>
                                    <br>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span>{{'%.0f'|format((ratingCount.TwoPoint / ratingCount.TotalRating)*100)}}%</span>
                                    <br>
                                    <span class="text-warning"><i class="fa fa-star " aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span class="text-warning"><i class="fa fa-star-o" aria-hidden="true"></i></span>
                                    <span>{{'%.0f'|format((ratingCount.OnePoint / ratingCount.TotalRating)*100)}}%</span>
                                </div>
                            </div>
                        </div>


                        {% for commentAndRating in commentAndRatingArray %}
                            <div class="list-group-item d-flex justify-content-center">
                                <img src="{{commentAndRating.AvatarURL}}" class="rounded-circle" width="76px" height="76px">
                                <div class="col d-flex justify-content-between">
                                    <div class="bg-light pt-1 pb-2 px-2" style="border-radius: 16px; width: 100%;">
                                        <strong>{{commentAndRating.Fullname}}
                                        </strong>
                                        <span class="float-right">
                                            <strong>
                                                <i class="fa fa-clock-o text" aria-hidden="true"></i>
                                                <script>displayCommentDate('{{commentAndRating.CommentDate}}')</script>
                                            </strong>
                                            <strong> | </strong>
                                            <strong>Điểm đánh giá: {{commentAndRating.RatingPoint}}</strong>
                                            <i class="text-warning fa fa-star-half-o" aria-hidden="true"></i>
                                        </span>
                                        <p>{{commentAndRating.CommentContent}}</p>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% endif %}

                    
                </div>
            </div>
        </div>
    {% endif %}

    
    
    {% include 'Include/Footer.html'%}

    <script>
            function displayRatingPointToStar(ratingPoint){
                ratingStar = Math.floor(ratingPoint);
                ratingHalfStar = ratingPoint - ratingStar;

                if(ratingPoint > 0){
                    ratingForm = document.getElementById('rating-form');
                    ratingForm.innerHTML = '';

                    for(var i = 1; i <= 5; i++){

                        if( ratingStar == i && ratingHalfStar >= 0.5 ){
                            let spanElement = document.createElement('span');
                            spanElement.setAttribute('onclick', 'displayRatingPointToStar('+i+')');

                            spanElement.innerHTML = `
                                <input class="star" onclick="displayRatingPointToStar('`+i+`')"  id="star-`+i+`" type="radio" name="rating-point" value=`+ratingPoint+`/>
                                <label class="star-icon text-warning fa fa-star-half-o for="star-`+i+`"></label>
                            `;

                            ratingForm.appendChild(spanElement);

                            continue;
                        }

                        if(i <= ratingStar){

                            let spanElement = document.createElement('span');
                            spanElement.setAttribute('onclick', 'displayRatingPointToStar('+i+')');

                            spanElement.innerHTML = `
                                <input class="star" onclick="displayRatingPointToStar('`+i+`')"  id="star-`+i+`" type="radio" name="rating-point" value=`+ratingPoint+`/>
                                <label class="star-icon text-warning fa fa-star for="star-`+i+`"></label>
                            `;

                            ratingForm.appendChild(spanElement);
                        }
                        else{
                            let spanElement = document.createElement('span');
                            spanElement.setAttribute('onclick', 'displayRatingPointToStar('+i+')');

                            spanElement.innerHTML = `
                                <input class="star" onclick="displayRatingPointToStar('`+i+`')"  id="star-`+i+`" type="radio" name="rating-point" value=`+ratingPoint+`/>
                                <label class="star-icon fa fa-star-o for="star-`+i+`"></label>
                            `;

                            ratingForm.appendChild(spanElement);
                        }
                    }

                    ratingPointInput = document.getElementById('rating-point');
                    ratingPointInput.value = ratingPoint;
                }
            }
    </script>
    
</body>
</html>